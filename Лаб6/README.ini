
Проблемы
- `process_checkout` - монолитен: в одной функции все собрано, лучше разделить на разные функции.
- "Чем гуще лес, тем if else if else". Код плохо читается,а значит легко случайно сломать при правках.
- Ставка налога, проценты скидок, пороги были прямо в коде, без понятных названий и введения переменных.

Правки:
- Разбил логику на небольшие функции:
  - валидация запроса,
  - подсчёт `subtotal`,
  - расчёт скидки,
  - расчёт налога,
  - генерация `order_id`.
- Вынес в константы (налог, проценты и скидки купонов).
- Сделал так, чтобы `process_checkout` читался как сценарий сверху вниз: parse → validate → calculate → return**.

Заметные улучшения:
- Главная функция стала заметно короче и понятнее.
- Правила скидок теперь локализованы и их проще менять/добавлять.
- Поддерживать и тестировать код легче, потому что каждая маленькая функция делает одну вещь.
